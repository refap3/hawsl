# generate BANNER here: 
# http://patorjk.com/software/taag

#   _   _     _         _       _    _ ____  _    _ _   _ _______ _    _             _____ _____ _______ _    _ _    _ ____     _ _ 
#  | | | |   (_)       (_)     | |  | |  _ \| |  | | \ | |__   __| |  | |     ____  / ____|_   _|__   __| |  | | |  | |  _ \   | | |
#  | |_| |__  _ ___     _ ___  | |  | | |_) | |  | |  \| |  | |  | |  | |    / __ \| |  __  | |    | |  | |__| | |  | | |_) |  | | |
#  | __| '_ \| / __|   | / __| | |  | |  _ <| |  | | . ` |  | |  | |  | |   / / _` | | |_ | | |    | |  |  __  | |  | |  _ <   | | |
#  | |_| | | | \__ \   | \__ \ | |__| | |_) | |__| | |\  |  | |  | |__| |  | | (_| | |__| |_| |_   | |  | |  | | |__| | |_) |  |_|_|
#   \__|_| |_|_|___/   |_|___/  \____/|____/ \____/|_| \_|  |_|   \____/    \ \__,_|\_____|_____|  |_|  |_|  |_|\____/|____/   (_|_)
#                                                                            \____/                                                 
                                                                                                                                  
# # # note: Github location is 
# # # https://github.com/refap3/hawsl


# # # how to update Homeassistant: 
# ===================================

# # # $ python3 -m pip install --upgrade homeassistant  

# ALL FILES are now local on C:\ drive and accessed via /mnt/c !!
# ---------------------------------------------------------------
# ===============================================================

homeassistant:
  # Name of the location where Home Assistant is running
  name: UBUNTU/Windows Test FARM
  # Location required to calculate the time the sun rises and sets
  latitude: 48.193182
  longitude: 16.360460
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 120
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Vienna
  # Customization file
  customize: !include customize.yaml 



# change Theme !!
frontend:
  themes:
    happy:
      primary-color: pink
    sad:
      primary-color: blue
    dark:
      primary-color: black

# Enables configuration UI
config:

updater:

# Discover some devices automatically
discovery:
  ignore:
  - apple_tv
  - axis
  - belkin_wemo
  - bluesound
  - bose_soundtouch
  - denonavr
  - directv
  - frontier_silicon
  - google_cast
  - harmony
  - ikea_tradfri
  - logitech_mediaserver
  - netgear_router
  - openhome
  - panasonic_viera
  - philips_hue
  - plex_mediaserver
  - roku
  - sabnzbd
  - samsung_printer
  - samsung_tv
  - sonos
  - songpal 
  - tellstick
  - wink
  - yamaha
  - yeelight
  - xiaomi_gw  

# Enables support for tracking state changes over time
history:

# View all events in a logbook
logbook:

# Enables a map showing the location of tracked devices
map:
sensor:

- platform: template
  sensors:
    vz_light_daytime:
      friendly_name: 'VZ light daytime '
      value_template: >-
        {% set o = 'day' %}
        {% if (states.sun.sun.attributes.elevation | int < 4 )   %}
          {% if ( states('sensor.time') >= '14:30' and states('sensor.time') < '22:30' ) %}
            {% set o = 'evening' %}
          {% elif ( states('sensor.time') >= '06:30' and states('sensor.time') < '09:30' ) %}
            {% set o = 'morning' %}
          {% else %}
            {% set o = 'night' %}
          {% endif %}
        {% endif %}
            {{ o }}    

- platform: template
  sensors:
    presence:
      friendly_name: 'Presence Sensor'
      value_template: >-
        {% set o = 'home' %}
        {% if states('input_select.forcepresencesimulation')  == 'True' %}
          {% set o = 'not_home' %}
        {% else %}
          {% if ( (states('input_number.pres_counter') | int == 1 ) and (states('sensor.vz_light_daytime') == 'evening' )  ) %}
            {% if ( (states('group.people')  == 'not_home' ) and (states('input_select.presenceenabled') == 'True' )  ) %}
              {% set o = 'not_home' %}
            {% endif %}
          {% endif %}
        {% endif %}
        {{ o }}    

- platform: template
  sensors:
    presence2:
      friendly_name: 'Presence Sensor2'
      value_template: >-
        {% set o = 'home' %}
        {% if states('input_select.forcepresencesimulation')  == 'True' %}
          {% set o = 'not_home' %}
        {% else %}
          {% if ( (states('input_number.pres_counter') | int == 1 ) and (states('sensor.vz_light_daytime') == 'day' )  ) %}
            {% if ( (states('group.people')  == 'home' ) and (states('input_select.presenceenabled') == 'True' )  ) %}
              {% set o = 'not_home' %}
            {% endif %}
          {% endif %}
        {% endif %}
        {{ o }}    

# HUE dimmer button and last changed 
- platform: rest 
  resource: http://192.168.1.29/api/afuqJ7LmBQWbHTQ0qKtGvuokd3y77SiJNw0BNkMy/sensors/7
  name: DIMMERbuttonevent
  value_template: '{{ value_json.state.buttonevent }}' 
  scan_interval: 1 

- platform: rest 
  resource: http://192.168.1.29/api/afuqJ7LmBQWbHTQ0qKtGvuokd3y77SiJNw0BNkMy/sensors/7
  name: DIMMERlastupdated
  value_template: '{{ value_json.state.lastupdated }}' 
  scan_interval: 1 


# HUE dimmer battery level 
- platform: rest 
  resource: http://192.168.1.29/api/afuqJ7LmBQWbHTQ0qKtGvuokd3y77SiJNw0BNkMy/sensors/7
  name: DIMMERbattery
  value_template: '{{ value_json.config.battery }}' 
  scan_interval: 1 

## HUE daylight boolean
- platform: rest 
  resource: http://192.168.1.29/api/afuqJ7LmBQWbHTQ0qKtGvuokd3y77SiJNw0BNkMy/sensors/1
  name: HUEdaylight
  value_template: '{{ value_json.state.daylight }}' 
  scan_interval: 1 

## HUE TAP switch 
- platform: rest 
  resource: http://192.168.1.29/api/afuqJ7LmBQWbHTQ0qKtGvuokd3y77SiJNw0BNkMy/sensors/22
  name: TAPbuttonevent
  value_template: '{{ value_json.state.buttonevent }}' 
  scan_interval: 1 

## get EXTERNAL IP 
- platform: rest
  resource: http://ip.jsontest.com
  name: External IP
  value_template: '{{ value_json.ip }}'

- platform: template 
  sensors:  
   living_room_remote_status: 
     friendly_name: 'Living room remote' 
     value_template: '{{states.sensor.DIMMERbuttonevent.state[0]}}'  
   
- platform: template 
  sensors:  
   full_living_room_remote_status: 
     friendly_name: 'FULL Living room remote' 
     value_template: '{{states.sensor.DIMMERbuttonevent.state}}'  
   
## fetch Multiple values and present as attributes
- platform: rest
  name: JSON time
  json_attributes:
    - date
    - milliseconds_since_epoch
  resource: http://date.jsontest.com/
  value_template: '{{ value_json.time }}'
- platform: template
  sensors:
    date:
      friendly_name: 'Date'
      value_template: '{{ states.sensor.json_time.attributes["date"] }}'
    milliseconds:
      friendly_name: 'milliseconds'
      value_template: '{{ states.sensor.json_time.attributes["milliseconds_since_epoch"] }}'

- platform: time_date
  display_options:
    - 'time'
    - 'date'
    - 'date_time'
    - 'date_time_iso'
    - 'time_date'
    - 'time_utc'
    - 'beat'

# give SUN
sun:

# device tracker ... 

device_tracker:
  - platform: ping
    interval_seconds: 20
    consider_home: 60
    hosts:
      rai_ph: 192.168.1.67
      lis_ph: 192.168.1.54


input_select:
  presenceenabled:
    name: Presence detection enabled 
    options:
     - true
     - false
    initial: true
    icon: mdi:human-male-female        

  forcepresencesimulation:
    name: FORCE Presence simulation
    options:
     - true
     - false
    initial: false
    icon: mdi:human-male-female        

input_number:
  pres_counter:
    name: Presence counter emulation 
    initial: 0
    min: 0
    max: 5
    icon: "mdi:brightness-5"   

# pushbullet

notify:
  platform: pushbullet
  name: pushbullet
  api_key: !secret pushbullet_api

counter:
  pres_simul_exec_counter:
    initial: 0
    step: 1
    name: Number of Presence Simulations executed

## enable python scripts in folder python_scripts
python_script:



group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml


